<?xml version="1.0" encoding="UTF-8"?>

<beans xsi:schemaLocation=" http://www.springframework.org/schema/beans 
http://www.springframework.org/schema/beans/spring-beans.xsd
 http://www.springframework.org/schema/context 
 http://www.springframework.org/schema/context/spring-context.xsd 
 http://www.springframework.org/schema/mvc 
 http://www.springframework.org/schema/mvc/spring-mvc.xsd
  http://www.springframework.org/schema/security 
http://www.springframework.org/schema/security/spring-security.xsd"
 xmlns:security="http://www.springframework.org/schema/security" 
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
xmlns:context="http://www.springframework.org/schema/context" 
xmlns:mvc="http://www.springframework.org/schema/mvc" 
xmlns="http://www.springframework.org/schema/beans">


<security:http auto-config="true">
<security:intercept-url access="permitAll" pattern="/login"/>
<security:intercept-url access="permitAll" pattern="/webapp/resources/**"/>
<security:intercept-url access="hasRole(ROLE_ADMIN)" pattern="/admin/**"/>
<security:form-login authentication-failure-forward-url="/goToLogin" authentication-success-forward-url="/userLogged" password-parameter="password" username-parameter="username" login-processing-url="/perform_login" login-page="/login"/>

<security:access-denied-handler error-page="/error"/>
<security:csrf disabled="true"/>
<security:logout logout-success-url="/" invalidate-session="true" logout-url="/logout"/>
</security:http>

<security:authentication-manager>
<security:authentication-provider>
<security:jdbc-user-service
     authorities-by-username-query="select email,role from user where email=?"
     users-by-username-query="select email,password,'true' as enabled from user where email=?"
     data-source-ref="dataSource"/>
</security:authentication-provider>
</security:authentication-manager>

</beans>